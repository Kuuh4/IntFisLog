/* autogenerated by Processing revision 1286 on 2022-11-13 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class V4 extends PApplet {

//declaração os usos da classe nova (pra alocar as variáveis delas)
Bola[] bolas = new Bola[100];
float varAccel = (2);
int accelFormula = 1;

float tam_tela_min;
float diagonal_tela;
int backgroundx;
boolean switch_bg;

int pos_x;
int pos_y;

int main_color = color(255, 255, 255);
int gradA_color = color(255, 255, 255);
int gradB_color = color(255, 0, 0);


 public void setup() {
    //size(500,400,P2D);
    //fullScreen(P2D);
    
    diagonal_tela = dist(0,0,width,height);
    tam_tela_min = min(width,height);
    backgroundx=0;
    
    //criação do objeto
    formulaAccel_A();
    
    
    noCursor();
    noStroke();
}

 public void draw() {

    //input_mouse();
    
    planodefundo();
    bolasseguiremA();
    //bolamouse();

}

 public void mouseClicked(){
    input_pos_aleatorio();
}
class Bola{
    //variáveis declaradas
    float accel, diameter;
    float x, y, dx, dy, targetx, targety, distancia_pos, variacao_cor, variacao_size;

//constructors
    Bola(float tempAccel){
        //conversão da variável de argumento (temporária) para uma variável de fato (inicializando ela)
        accel = tempAccel;
        diameter = tam_tela_min/8;
    }

    Bola(float tempAccel,float tempDiameter){
        //conversão da variável de argumento (temporária) para uma variável de fato (inicializando ela)
        accel = tempAccel;
        diameter = tempDiameter;
    }
    

//Functions

     public void update(){

        //inicializando e usando as variáveis
        
        targetx = pos_x; targety = pos_y;
        dx = targetx - x; dy = targety - y;
        
        //calculando a distancia linear da bola ate o mouse
        distancia_pos = dist(pos_x,pos_y,x,y);
        
        //calculando a posicao da bola
        if (distancia_pos>=0.5f){
            x += dx * accel; y += dy * accel;
            //criando uma variacao de valores de 0 para 1 baseado na distancia e tamanho da tela
            variacao_cor = distancia_pos/(tam_tela_min/2);
        } else {
            x = pos_x; y = pos_y;
            variacao_cor = distancia_pos/tam_tela_min;
        }

        variacao_size = distancia_pos/diagonal_tela;
        
        //noFill();
        fill(lerpColor(gradA_color, gradB_color, variacao_cor));

        //usando as variáveis
        ellipse(x, y, diameter*(1-variacao_size), diameter*(1-variacao_size));
    }
}

//PROCESSO DO VOID SETUP, OCORRE SOMENTE 1x PRA ALOCAR MEMÓRIA. NÂO INTERFERE EM VOIDDRAW()

//Código Chamado dentro de void setup()
//Fórmulas de variação de aceleração para construtor de Bola() baseado na quantidade de bolas.


 public void formulaAccel_A(){
    //Cada bola tem cada vez menos arracada     
        for (int i = 0; i < bolas.length; ++i) {
        bolas[i] = new Bola((1/(sq(varAccel)))/(i+1));
        }
}


 public void formulaAccel_B(){
    

    for (int i = 0; i < bolas.length; ++i) {
    bolas[i] = new Bola((1/(sq(varAccel)))/(i+1));
    }
}
// Funções do código principal

 public void planodefundo(){
    //Planos de fundo
        //plano de fundo variável
            if(switch_bg==true){backgroundx++;}else{backgroundx--;}
            if(backgroundx<=0){ switch_bg = true;}
            if(backgroundx>=255){ switch_bg = false;}

            //println(switch_bg+" | "+backgroundx); //debug cor fundo
            //background(backgroundx,backgroundx,255-backgroundx);
        
        //plano de fundo simples
            background(128);
}

 public void bolasseguiremA(){
    // Bolas se desenham na ordem da mais longe do mouse para mais perto. 
    //A bola desenhada + perto do mouse tá por cima   
        for (int i = (bolas.length-1); i >= 0 ; --i) {
        bolas[i].update();
        }
}

 public void bolasseguiremB(){
    // Bolas se desenham na ordem da mais perto do mouse para mais longe. 
    //A bola desenhada + longe do mouse tá por cima    
         for (int i = 0; i < bolas.length; ++i) {
        bolas[i].update();
    }
}

 public void bolamouse(){
    //bola mouse
        fill(main_color);
        ellipse(pos_x, pos_y, bolas[0].diameter*(1-bolas[0].variacao_size), bolas[0].diameter*(1-bolas[0].variacao_size));
}

 public void input_pos_aleatorio(){
    pos_x=PApplet.parseInt(random(0,width));
    pos_y=PApplet.parseInt(random(0,height));
}

 public void input_mouse(){
    pos_x = mouseX;
    pos_y = mouseY;
}


  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "V4" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
